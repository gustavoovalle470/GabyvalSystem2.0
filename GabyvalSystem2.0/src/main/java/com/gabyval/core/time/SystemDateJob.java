/* *****************************************************************************************************************************************************
 * *****************************************************************************************************************************************************
 * *****************************************************************************************************************************************************
 * *******************************                                                                              ****************************************
 * *******************************  ********** ********** ******    **      ** **      ** ********** **         ****************************************
 * *******************************  ********** **********  ******   **      ** **      ** ********** **         ****************************************
 * *******************************  **         **      **  **  **   **      ** **      ** **      ** **         ****************************************
 * *******************************  **         **      **  **  **   **      ** **      ** **      ** **         ****************************************
 * *******************************  **         **      **  ******    **    **  **      ** **      ** **         ****************************************
 * *******************************  **    **** **********  *******    **  **   **      ** ********** **         ****************************************
 * *******************************  **    **** **********  ********    ****    **      ** ********** **         ****************************************
 * *******************************  **      ** **      **  **    **     **     **      ** **      ** **         ****************************************
 * *******************************  **      ** **      **  **    **     **      **    **  **      ** **         ****************************************
 * *******************************  **      ** **      **  **   **      **       **  **   **      ** **         ****************************************
 * *******************************  ********** **      **  **  **       **        ****    **      ** ********** ****************************************
 * *******************************  ********** **      ** ******        **         **     **      ** ********** ****************************************
 * *****************************************************************************************************************************************************
 * *****************************************************************************************************************************************************
 * *****************************************************************************************************************************************************
 * |---------------------------------------------------------------------------------------------------------------------------------------------------|
 * |                                                        Control de versiones                                                                       |
 * |---------|--------------|----------------|---------------------------------------------------------------------------------------------------------|
 * | Version |    Fecha     |  Responsable   |                                                  Comentarios                                            |
 * |---------|--------------|----------------|---------------------------------------------------------------------------------------------------------|
 * |   1.0   |  04/06/2018  |      GAOQ      | Creacion del scheduler para el timer central del aplicativo.                                            |
 * |---------|--------------|----------------|---------------------------------------------------------------------------------------------------------|
*/
package com.gabyval.core.time;

import com.gabyval.core.exception.GB_Exception;
import com.gabyval.core.logger.GB_Logger;
import com.gabyval.core.scheduler.Job;
import java.util.Calendar;
import org.quartz.JobExecutionContext;
import org.quartz.JobExecutionException;

/**
 * This class describe the control job, manager all jobs.
 * @author GAOQ
 * @version 1.1
 * @since 19/06/2017.
 */
public class SystemDateJob extends Job{
    
    private final GB_Logger LOG = GB_Logger.getLogger(SystemDateJob.class); //Log central.

    /**
     * The method to execute into the Scheduler.
     * @param jec the execution context.
     * @throws JobExecutionException :
     */
    @Override
    public void execute(JobExecutionContext jec) throws JobExecutionException {
        Calendar sysUpdate = Calendar.getInstance();
        try {
            sysUpdate.setTime(SystemDateController.getInstance().getSystemDate());
            sysUpdate.add(Calendar.SECOND, 1);
            SystemDateController.getInstance().changeDate(sysUpdate.getTime(), Controls.SYSTEM_DATE);
        } catch (GB_Exception ex) {
                LOG.fatal(ex);
        }
    }
}
